<!DOCTYPE html>
<html>
	<head>
                <script src="https://apis.mapmyindia.com/advancedmaps/v1/oehzgx54nik3ur7upodu32splbu6gxw5/map_load?v=1.5"></script>
                <style>
                    html, body, #map {	margin: 0;	padding: 0;width: 100%;height: 100%;}
                    #map {
                        margin:50px;
                        padding:20px;
                    }
                </style>
	</head>

<body>

<p>Click the button to get your coordinates.</p>

<button id="find-me" onclick="getLocation()">Try It</button>

<p id="demo"></p>

<div id="map"></div>

<script>
var x = document.getElementById("demo");

var lat = 30;
var long = 78;

    var apikey = 'd25ac72e7a1e43b8a2d3c939895889d1';

    var api_url = 'https://api.opencagedata.com/geocode/v1/json'


  // see full list of required and optional parameters:
  // https://opencagedata.com/api#forward

function showPosition(position) {
    x.innerHTML="Latitude: " + position.coords.latitude +
    "<br>Longitude: " + position.coords.longitude;
    lat = position.coords.latitude;
    long = position.coords.longitude;
    var map=new MapmyIndia.Map("map",{ center:[lat, long], zoomControl: true, hybrid:true, search:true, location:true});

    var latitude = lat;
    var longitude = long;
    var request_url = api_url
        + '?'
        + 'key=' + apikey
        + '&q=' + encodeURIComponent(latitude + ',' + longitude)
        + '&pretty=1'
        + '&no_annotations=1';

    var request = new XMLHttpRequest();
    request.open('GET', request_url, true);

    request.onload = function() {
    // see full list of possible response codes:
    // https://opencagedata.com/api#codes

    if (request.status == 200){
      // Success!
      var data = JSON.parse(request.responseText);
      alert(data.results[0].formatted);

    } else if (request.status <= 500){
      // We reached our target server, but it returned an error

      console.log("unable to geocode! Response code: " + request.status);
      var data = JSON.parse(request.responseText);
      console.log(data.status.message);
    } else {
      console.log("server error");
    }
    };

    request.onerror = function() {
        // There was a connection error of some sort
        console.log("unable to connect to server");
    };

    request.send();  // make the request

}

function getLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.watchPosition(showPosition);
  } else {
    x.innerHTML = "Geolocation is not supported by this browser.";
  }
}


</script>


</body>
</html>
